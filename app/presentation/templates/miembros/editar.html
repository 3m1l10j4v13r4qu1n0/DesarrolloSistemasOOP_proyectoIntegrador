<!-- 
==================================================
Formulario para editar miembro - CORREGIDO
==================================================
-->
{% extends "layout.html" %}

{% block title %}Editar Miembro{% endblock %}

{% block content %}
<div>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="color: #667eea;">Editar Miembro</h2>
        <div>
            <a href="{{ url_for('miembros.detalle', id_miembro=miembro.id_miembro) }}" class="btn btn-info">
                <i class="bi bi-eye"></i> Ver Detalle
            </a>
            <a href="{{ url_for('miembros.listar') }}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>
    </div>
    
    {% include('partials/_header.html') %}

    <div class="card">
        <div class="card-header">
            <h4 class="mb-0">
                <i class="bi bi-pencil-square"></i> Editar Información del Miembro
            </h4>
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('miembros.actualizar', id_miembro=miembro.id_miembro) }}">
                <div class="row">
                    <!-- Nombre -->
                    <div class="col-md-6 mb-3">
                        <label for="nombre" class="form-label">Nombre *</label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="nombre" 
                            name="nombre" 
                            required
                            maxlength="50"
                            value="{{ miembro.nombre }}"
                            placeholder="Ingrese el nombre">
                    </div>

                    <!-- Apellido -->
                    <div class="col-md-6 mb-3">
                        <label for="apellido" class="form-label">Apellido *</label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="apellido" 
                            name="apellido" 
                            required
                            maxlength="50"
                            value="{{ miembro.apellido }}"
                            placeholder="Ingrese el apellido">
                    </div>
                </div>

                <div class="row">
                    <!-- Email -->
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label">Email *</label>
                        <input 
                            type="email" 
                            class="form-control" 
                            id="email" 
                            name="email" 
                            required
                            maxlength="100"
                            value="{{ miembro.email }}"
                            placeholder="ejemplo@correo.com">
                        <small class="text-muted">El email debe ser único en el sistema</small>
                    </div>

                    <!-- Rol -->
                    <div class="col-md-6 mb-3">
                        <label for="rol" class="form-label">Rol *</label>
                        <select class="form-select" id="rol" name="rol" required>
                            <option value="">Seleccione un rol</option>
                            <option value="Desarrollador" {% if miembro.rol == 'Desarrollador' %}selected{% endif %}>Desarrollador</option>
                            <option value="Diseñador" {% if miembro.rol == 'Diseñador' %}selected{% endif %}>Diseñador</option>
                            <option value="Project Manager" {% if miembro.rol == 'Project Manager' %}selected{% endif %}>Project Manager</option>
                            <option value="QA Tester" {% if miembro.rol == 'QA Tester' %}selected{% endif %}>QA Tester</option>
                            <option value="DevOps" {% if miembro.rol == 'DevOps' %}selected{% endif %}>DevOps</option>
                            <option value="Product Owner" {% if miembro.rol == 'Product Owner' %}selected{% endif %}>Product Owner</option>
                            <option value="Scrum Master" {% if miembro.rol == 'Scrum Master' %}selected{% endif %}>Scrum Master</option>
                            <option value="Analista" {% if miembro.rol == 'Analista' %}selected{% endif %}>Analista</option>
                        </select>
                    </div>
                </div>

                <div class="row">
                    <!-- Fecha de Ingreso -->
                    <div class="col-md-6 mb-3">
                        <label for="fecha_ingreso" class="form-label">Fecha de Ingreso *</label>
                        <input 
                            type="date" 
                            class="form-control" 
                            id="fecha_ingreso" 
                            name="fecha_ingreso" 
                            required
                            value="{{ miembro.fecha_ingreso }}">
                    </div>
                </div>

                <!-- Información adicional -->
                <div class="alert alert-info">
                    <strong><i class="bi bi-info-circle"></i> Información:</strong>
                    <ul class="mb-0 mt-2">
                        <li>ID del miembro: <strong>{{ miembro.id_miembro }}</strong></li>
                    </ul>
                </div>

                <div class="mt-4">
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-save"></i> Actualizar Miembro
                    </button>
                    <a href="{{ url_for('miembros.detalle', id_miembro=miembro.id_miembro) }}" class="btn btn-secondary">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </a>
                    <form method="POST" action="{{ url_for('miembros.eliminar', id_miembro=miembro.id_miembro) }}" style="display: inline;" class="float-end">
                        <button type="submit" class="btn btn-danger" onclick="return confirm('¿Estás seguro de eliminar este miembro? Esta acción no se puede deshacer.')">
                            <i class="bi bi-trash"></i> Eliminar Miembro
                        </button>
                    </form>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}